{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport AdminNavigation from '@/components/admin/AdminNavigation.vue';\nimport RoundedBox from '@/components/base/RoundedBox.vue';\nimport TheAlert from '@/components/base/TheAlert.vue';\nimport DeleteModal from '@/components/base/DeleteModal.vue';\nimport axios from \"@/misc/axios.js\";\nexport default {\n  components: {\n    AdminNavigation,\n    RoundedBox,\n    TheAlert,\n    DeleteModal\n  },\n  data() {\n    return {\n      // v-model dos campos do formulário\n      tipo: 0,\n      campus: 0,\n      // Flags de validação\n      validTipo: true,\n      validCampus: true,\n      // Flags de campos ativos para setar o z-index\n      activeTipo: false,\n      activeCampus: false,\n      // Tipos de usuário e Campi do SELECT do formulário\n      tipos: [],\n      campi: [],\n      // Dados da tabela\n      usuarios: [],\n      // Usados para exibir o spinner\n      isShowing: false,\n      isDeleting: false,\n      // Arrays de erros\n      errorMessages: [],\n      // Dados para deletar um Usuario\n      deleteModal: false,\n      deleteId: 0,\n      deleteNome: '',\n      deleteEmail: '',\n      deleteCampus: ''\n    };\n  },\n  methods: {\n    async loadCampi() {\n      try {\n        this.campi = [];\n        this.errorMessages = [];\n        let response = null;\n        response = await axios.get(\"/campi/index\");\n        if (response.data) this.campi = response.data;\n      } catch (error) {\n        this.handleError(error);\n      }\n    },\n    async loadTipos() {\n      try {\n        this.tipos = [];\n        this.errorMessages = [];\n        let response = null;\n        response = await axios.get(\"/tipos/index\");\n        if (response.data) this.tipos = response.data;\n      } catch (error) {\n        this.handleError(error);\n      }\n    },\n    getDescricaoCampus(id) {\n      let campiList = this.campi;\n      let campus = campiList.find(c => c.id == id);\n      return campus ? campus.descricao : '';\n    },\n    getDescricaoTipoUsuario(id) {\n      let tiposList = this.tipos;\n      let tipo = tiposList.find(t => t.id == id);\n      return tipo ? tipo.descricao : '';\n    },\n    async showUsuarios() {\n      try {\n        this.isShowing = true;\n        this.usuarios = [];\n        this.errorMessages = [];\n        let response = null;\n        const tipo = Number(this.tipo);\n        const campus = Number(this.campus);\n        const payload = {\n          campus,\n          tipo\n        };\n        response = await axios.get(\"/admin/usuarios\", {\n          params: payload\n        });\n        if (response.data) this.usuarios = response.data;\n      } catch (error) {\n        this.handleError(error);\n      } finally {\n        this.isShowing = false;\n      }\n    },\n    async deleteUsuario(id) {\n      this.hideDeleteModal();\n      this.isDeleting = true;\n      try {\n        this.errorMessageTable = [];\n        let response = null;\n        response = await axios.delete(`/admin/usuario/${id}`);\n        if (response.status === 200) this.showUsuarios();\n      } catch (error) {\n        this.handleError(error);\n      } finally {\n        this.isDeleting = false;\n      }\n    },\n    showDeleteModal(id, nome, email, campus) {\n      this.deleteId = id;\n      this.deleteNome = nome;\n      this.deleteEmail = email;\n      this.deleteCampus = campus;\n      this.deleteModal = true;\n    },\n    hideDeleteModal() {\n      this.deleteId = 0;\n      this.deleteNome = '';\n      this.deleteEmail = '';\n      this.deleteCampus = '';\n      this.deleteModal = false;\n    },\n    handleError(error) {\n      if (error.response && error.response.data && error.response.data.error) this.errorMessages.push(error.response.data.error);else this.errorMessages.push(error.message);\n    }\n  },\n  mounted() {\n    this.loadCampi();\n    this.loadTipos();\n    this.showUsuarios();\n  }\n};","map":{"version":3,"names":["AdminNavigation","RoundedBox","TheAlert","DeleteModal","axios","components","data","tipo","campus","validTipo","validCampus","activeTipo","activeCampus","tipos","campi","usuarios","isShowing","isDeleting","errorMessages","deleteModal","deleteId","deleteNome","deleteEmail","deleteCampus","methods","loadCampi","response","get","error","handleError","loadTipos","getDescricaoCampus","id","campiList","find","c","descricao","getDescricaoTipoUsuario","tiposList","t","showUsuarios","Number","payload","params","deleteUsuario","hideDeleteModal","errorMessageTable","delete","status","showDeleteModal","nome","email","push","message","mounted"],"sources":["C:\\Users\\THIAGO\\Documents\\Estágios\\sce-front\\src\\components\\admin\\AdminUsuario.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <AdminNavigation />\r\n\r\n    <div class=\"container\">\r\n\r\n      <RoundedBox>\r\n\r\n        <h3 class=\"text-center\">{{ $t('header.admin.usuario') }}</h3>\r\n\r\n        <div class=\"sce-form\">\r\n          <form @submit.prevent=\"\">\r\n\r\n            <div :class=\"{\r\n          'z-1': !activeTipo && validTipo,\r\n          'z-2': !activeTipo && !validTipo,\r\n          'z-3': activeTipo,\r\n        }\" class=\"form-floating\">\r\n              <select v-model.trim=\"tipo\" class=\"form-select sce-form-top\" @focus=\"activeTipo = true\"\r\n                @blur=\"activeTipo = false\" :class=\"{ 'is-invalid': !validTipo }\" id=\"tipoUsuario\" name=\"tipoUsuario\"\r\n                @change=\"showUsuarios\">\r\n                <option value=\"0\">{{ $t('label.todos') }}</option>\r\n                <option v-for=\"t in tipos\" :key=\"t.id\" :value=\"t.id\">{{ t.descricao }}</option>\r\n              </select>\r\n              <label for=\"tipoUsuario\">{{ $t('label.tipo') }}</label>\r\n            </div>\r\n\r\n            <div :class=\"{\r\n          'z-1': !activeCampus && validCampus,\r\n          'z-2': !activeCampus && !validCampus,\r\n          'z-3': activeCampus,\r\n        }\" class=\"form-floating\">\r\n              <select v-model.trim=\"campus\" class=\"form-select sce-form-bottom\" @focus=\"activeCampus = true\"\r\n                @blur=\"activeCampus = false\" :class=\"{ 'is-invalid': !validCampus }\" id=\"deleteCampus\"\r\n                name=\"deleteCampus\" @change=\"showUsuarios\">\r\n                <option value=\"0\">{{ $t('label.todos') }}</option>\r\n                <option v-for=\"c in campi\" :key=\"c.id\" :value=\"c.id\">{{ c.descricao }}</option>\r\n              </select>\r\n              <label for=\"deleteCampus\">{{ $t('label.campus') }}</label>\r\n            </div>\r\n\r\n            <TheAlert :messages=\"errorMessages\"></TheAlert>\r\n\r\n          </form>\r\n        </div>\r\n\r\n        <div v-if=\"errorMessages.length == 0 && (isShowing || isDeleting)\" class=\"d-flex justify-content-center mt-5\">\r\n          <div class=\"spinner-border\" role=\"status\">\r\n            <span class=\"sr-only\"></span>\r\n          </div>\r\n        </div>\r\n\r\n        <p v-if=\"errorMessages.length == 0 && !isShowing && !isDeleting && usuarios.length == 0\" class=\"text-center mt-5\">\r\n          {{ $t('message.admin.sem-usuarios') }}\r\n        </p>\r\n\r\n        <table class=\"table table-sm table-hover mt-5\"\r\n          v-if=\"errorMessages.length == 0 && !isShowing && !isDeleting && usuarios.length > 0\">\r\n\r\n          <thead>\r\n            <tr>\r\n              <th scope=\"col\">#</th>\r\n              <th scope=\"col\">{{ $t('label.nome') }}</th>\r\n              <th scope=\"col\">{{ $t('label.email') }}</th>\r\n              <th scope=\"col\">{{ $t('label.campus') }}</th>\r\n              <th scope=\"col\">{{ $t('label.tipo') }}</th>\r\n              <th scope=\"col\"></th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr v-for=\"u in usuarios\" :key=\"u.id\">\r\n              <th scope=\"row\">{{ u.id }}</th>\r\n              <td>{{ u.nome }}</td>\r\n              <td>{{ u.email }}</td>\r\n              <td>{{ getDescricaoCampus(u.campus) }}</td>\r\n              <td>{{ getDescricaoTipoUsuario(u.tipo) }}</td>\r\n\r\n              <td>\r\n                  <i class=\"bi bi-trash\" @click=\"showDeleteModal(\r\n                      u.id,\r\n                      u.nome,\r\n                      u.email,\r\n                      getDescricaoCampus(u.campus))\">\r\n                  </i>\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </RoundedBox>\r\n\r\n      <!-- Modal para deletar um Usuário -->\r\n      <Teleport to=\"body\">\r\n        <DeleteModal operation=\"delete\" :show=\"deleteModal\" :id=\"deleteId\" @close=\"hideDeleteModal\"\r\n          @delete=\"deleteUsuario\">\r\n          <template #body>\r\n            <p class=\"text-center fw-bold\">{{ $t('message.admin.delete-usuario') }}</p>\r\n            <p class=\"text-center text-danger\">\r\n              {{ deleteNome }}<br>\r\n              <span class=\"fst-italic\">{{ deleteEmail }}</span><br>\r\n              {{ $t('label.campus') }} {{ deleteCampus }}\r\n            </p>\r\n          </template>\r\n        </DeleteModal>\r\n      </Teleport>\r\n\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport AdminNavigation from '@/components/admin/AdminNavigation.vue';\r\nimport RoundedBox from '@/components/base/RoundedBox.vue';\r\nimport TheAlert from '@/components/base/TheAlert.vue';\r\nimport DeleteModal from '@/components/base/DeleteModal.vue';\r\nimport axios from \"@/misc/axios.js\";\r\n\r\nexport default {\r\n  components: {\r\n    AdminNavigation,\r\n    RoundedBox,\r\n    TheAlert,\r\n    DeleteModal,\r\n  },\r\n\r\n  data() {\r\n    return {\r\n      // v-model dos campos do formulário\r\n      tipo: 0,\r\n      campus: 0,\r\n\r\n      // Flags de validação\r\n      validTipo: true,\r\n      validCampus: true,\r\n\r\n      // Flags de campos ativos para setar o z-index\r\n      activeTipo: false,\r\n      activeCampus: false,\r\n\r\n      // Tipos de usuário e Campi do SELECT do formulário\r\n      tipos: [],\r\n      campi: [],\r\n\r\n      // Dados da tabela\r\n      usuarios: [],\r\n\r\n      // Usados para exibir o spinner\r\n      isShowing: false,\r\n      isDeleting: false,\r\n\r\n      // Arrays de erros\r\n      errorMessages: [],\r\n\r\n      // Dados para deletar um Usuario\r\n      deleteModal: false,\r\n      deleteId: 0,\r\n      deleteNome: '',\r\n      deleteEmail: '',\r\n      deleteCampus: '',\r\n    }\r\n  },\r\n\r\n  methods: {\r\n\r\n    async loadCampi() {\r\n      try {\r\n        this.campi = [];\r\n        this.errorMessages = [];\r\n        let response = null;\r\n\r\n        response = await axios.get(\"/campi/index\");\r\n\r\n        if (response.data)\r\n          this.campi = response.data;\r\n\r\n      } catch (error) {\r\n        this.handleError(error);\r\n      }\r\n    },\r\n\r\n    async loadTipos() {\r\n      try {\r\n        this.tipos = [];\r\n        this.errorMessages = [];\r\n        let response = null;\r\n\r\n        response = await axios.get(\"/tipos/index\");\r\n\r\n        if (response.data)\r\n          this.tipos = response.data;\r\n\r\n      } catch (error) {\r\n        this.handleError(error);\r\n      }\r\n    },\r\n\r\n    getDescricaoCampus(id) {\r\n      let campiList = this.campi;\r\n      let campus = campiList.find(c => c.id == id);\r\n      return campus ? campus.descricao : '';\r\n    },\r\n\r\n    getDescricaoTipoUsuario(id) {\r\n      let tiposList = this.tipos;\r\n      let tipo = tiposList.find(t => t.id == id);\r\n      return tipo ? tipo.descricao : '';\r\n    },\r\n\r\n    async showUsuarios() {\r\n      try {\r\n        this.isShowing = true;\r\n        this.usuarios = [];\r\n        this.errorMessages = [];\r\n        let response = null;\r\n\r\n        const tipo = Number(this.tipo);\r\n        const campus = Number(this.campus);\r\n\r\n        const payload = {\r\n          campus,\r\n          tipo,\r\n        };\r\n\r\n        response = await axios.get(\"/admin/usuarios\", {\r\n          params: payload\r\n        });\r\n\r\n        if (response.data)\r\n          this.usuarios = response.data;\r\n\r\n      } catch (error) {\r\n        this.handleError(error);\r\n      } finally {\r\n        this.isShowing = false;\r\n      }\r\n    },\r\n\r\n    async deleteUsuario(id) {\r\n      this.hideDeleteModal();\r\n      this.isDeleting = true;\r\n\r\n      try {\r\n        this.errorMessageTable = [];\r\n        let response = null;\r\n\r\n        response = await axios.delete(`/admin/usuario/${id}`);\r\n\r\n        if (response.status === 200)\r\n          this.showUsuarios();\r\n\r\n      } catch (error) {\r\n        this.handleError(error);\r\n\r\n      } finally {\r\n        this.isDeleting = false;\r\n      }\r\n    },\r\n\r\n    showDeleteModal(id, nome, email, campus) {\r\n      this.deleteId = id;\r\n      this.deleteNome = nome;\r\n      this.deleteEmail = email;\r\n      this.deleteCampus = campus;\r\n      this.deleteModal = true;\r\n    },\r\n\r\n    hideDeleteModal() {\r\n      this.deleteId = 0;\r\n      this.deleteNome = '';\r\n      this.deleteEmail = '';\r\n      this.deleteCampus = '';\r\n      this.deleteModal = false;\r\n    },\r\n\r\n    handleError(error) {\r\n      if (error.response && error.response.data && error.response.data.error)\r\n        this.errorMessages.push(error.response.data.error);\r\n      else\r\n        this.errorMessages.push(error.message);\r\n    },\r\n  },\r\n\r\n  mounted() {\r\n    this.loadCampi();\r\n    this.loadTipos();\r\n    this.showUsuarios();\r\n  },\r\n\r\n}\r\n</script>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}