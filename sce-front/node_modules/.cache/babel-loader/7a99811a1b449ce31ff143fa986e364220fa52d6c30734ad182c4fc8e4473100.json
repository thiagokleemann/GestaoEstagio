{"ast":null,"code":"import \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\n// Removido 'computed' e import do axios daqui\nimport UploadBox from \"./UploadBox.vue\";\nimport axios from \"@/misc/axios.js\"; // Mantemos o import do axios aqui para usar na função\n\nexport default {\n  __name: 'AccordionItem',\n  props: {\n    title: {\n      type: String,\n      required: true\n    },\n    content: {\n      type: String,\n      required: true\n    },\n    isOpen: {\n      type: Boolean,\n      default: false\n    },\n    tipoId: {\n      type: Number,\n      required: true\n    }\n  },\n  emits: [\"toggle\"],\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const props = __props;\n\n    // --- NOVA FUNÇÃO PARA DOWNLOAD VIA AXIOS ---\n    const baixarModelo = async () => {\n      try {\n        const response = await axios.get(`/download/${props.tipoId}`, {\n          responseType: \"blob\" // Importante: Pede a resposta como dados binários\n        });\n\n        // Pega o nome do arquivo do cabeçalho Content-Disposition (se existir)\n        const contentDisposition = response.headers[\"content-disposition\"];\n        let filename = `modelo_documento_${props.tipoId}.doc`; // Nome padrão\n        if (contentDisposition) {\n          const filenameMatch = contentDisposition.match(/filename=\"?(.+)\"?/i);\n          if (filenameMatch && filenameMatch.length === 2) {\n            filename = filenameMatch[1];\n          }\n        }\n\n        // Cria um link temporário para iniciar o download\n        const url = window.URL.createObjectURL(new Blob([response.data]));\n        const link = document.createElement(\"a\");\n        link.href = url;\n        link.setAttribute(\"download\", filename); // Usa o nome do arquivo obtido\n        document.body.appendChild(link);\n        link.click();\n\n        // Limpa o link temporário\n        link.parentNode.removeChild(link);\n        window.URL.revokeObjectURL(url);\n      } catch (error) {\n        console.error(\"Erro ao baixar o modelo:\", error);\n        // Exibe uma mensagem de erro para o usuário, se desejar\n        alert(\"Não foi possível baixar o modelo. Verifique o console para mais detalhes.\");\n        // Você pode usar o 'errorMessage' ref se o passar como prop ou usar um event bus\n      }\n    };\n    // --- FIM DA NOVA FUNÇÃO ---\n\n    const __returned__ = {\n      props,\n      baixarModelo,\n      UploadBox,\n      get axios() {\n        return axios;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["UploadBox","axios","props","__props","baixarModelo","response","get","tipoId","responseType","contentDisposition","headers","filename","filenameMatch","match","length","url","window","URL","createObjectURL","Blob","data","link","document","createElement","href","setAttribute","body","appendChild","click","parentNode","removeChild","revokeObjectURL","error","console","alert"],"sources":["C:/Users/THIAGO/Documents/Estágios/sce-front/src/components/UI/AccordionItem.vue"],"sourcesContent":["<script setup>\r\n\timport { defineProps, defineEmits } from \"vue\"; // Removido 'computed' e import do axios daqui\r\n\timport UploadBox from \"./UploadBox.vue\";\r\n\timport axios from \"@/misc/axios.js\"; // Mantemos o import do axios aqui para usar na função\r\n\r\n\tconst props = defineProps({\r\n\t\ttitle: {\r\n\t\t\ttype: String,\r\n\t\t\trequired: true,\r\n\t\t},\r\n\t\tcontent: {\r\n\t\t\ttype: String,\r\n\t\t\trequired: true,\r\n\t\t},\r\n\t\tisOpen: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false,\r\n\t\t},\r\n\t\ttipoId: {\r\n\t\t\ttype: Number,\r\n\t\t\trequired: true,\r\n\t\t},\r\n\t});\r\n\r\n\tdefineEmits([\"toggle\"]);\r\n\r\n\t// --- NOVA FUNÇÃO PARA DOWNLOAD VIA AXIOS ---\r\n\tconst baixarModelo = async () => {\r\n\t\ttry {\r\n\t\t\tconst response = await axios.get(`/download/${props.tipoId}`, {\r\n\t\t\t\tresponseType: \"blob\", // Importante: Pede a resposta como dados binários\r\n\t\t\t});\r\n\r\n\t\t\t// Pega o nome do arquivo do cabeçalho Content-Disposition (se existir)\r\n\t\t\tconst contentDisposition = response.headers[\"content-disposition\"];\r\n\t\t\tlet filename = `modelo_documento_${props.tipoId}.doc`; // Nome padrão\r\n\t\t\tif (contentDisposition) {\r\n\t\t\t\tconst filenameMatch = contentDisposition.match(/filename=\"?(.+)\"?/i);\r\n\t\t\t\tif (filenameMatch && filenameMatch.length === 2) {\r\n\t\t\t\t\tfilename = filenameMatch[1];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Cria um link temporário para iniciar o download\r\n\t\t\tconst url = window.URL.createObjectURL(new Blob([response.data]));\r\n\t\t\tconst link = document.createElement(\"a\");\r\n\t\t\tlink.href = url;\r\n\t\t\tlink.setAttribute(\"download\", filename); // Usa o nome do arquivo obtido\r\n\t\t\tdocument.body.appendChild(link);\r\n\t\t\tlink.click();\r\n\r\n\t\t\t// Limpa o link temporário\r\n\t\t\tlink.parentNode.removeChild(link);\r\n\t\t\twindow.URL.revokeObjectURL(url);\r\n\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Erro ao baixar o modelo:\", error);\r\n\t\t\t// Exibe uma mensagem de erro para o usuário, se desejar\r\n\t\t\talert(\"Não foi possível baixar o modelo. Verifique o console para mais detalhes.\");\r\n\t\t\t// Você pode usar o 'errorMessage' ref se o passar como prop ou usar um event bus\r\n\t\t}\r\n\t};\r\n\t// --- FIM DA NOVA FUNÇÃO ---\r\n\r\n</script>\r\n\r\n<template>\r\n\t<div class=\"accordion-item\">\r\n\t\t<div\r\n\t\t\tclass=\"accordion-header\"\r\n\t\t\t@click=\"$emit('toggle')\"\r\n\t\t>\r\n\t\t\t{{ title }}\r\n\t\t\t<span class=\"toggle-icon\">{{ isOpen ? \"▲\" : \"▼\" }}</span>\r\n\t\t</div>\r\n\r\n\t\t<div\r\n\t\t\tv-if=\"isOpen\"\r\n\t\t\tclass=\"accordion-content\"\r\n\t\t>\r\n\t\t\t<div class=\"mb-3\">\r\n\t\t\t\t<strong>Modelo:</strong>\r\n\t\t\t\t<a href=\"#\" @click.prevent=\"baixarModelo\">\r\n\t\t\t\t\tBaixar o modelo do documento\r\n\t\t\t\t</a>\r\n\t\t\t\t<p class=\"text-muted small\">\r\n\t\t\t\t\tPreencha o modelo, salve como PDF e envie abaixo.\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<hr>\r\n\r\n\t\t\t<p><strong>Envio:</strong></p>\r\n\t\t\t<UploadBox :multiple=\"false\" />\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<style scoped>\r\n\t/* Seus estilos permanecem os mesmos */\r\n\t.accordion-item {\r\n\t\tborder-bottom: 1px solid #eee;\r\n\t}\r\n\t.accordion-header {\r\n\t\tpadding: 10px;\r\n\t\tcursor: pointer;\r\n\t\tbackground-color: #f7f7f7;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\tfont-weight: 500;\r\n\t}\r\n\t.accordion-header:hover {\r\n\t\tbackground-color: #eee;\r\n\t}\r\n\t.toggle-icon {\r\n\t\tmargin-left: 10px;\r\n\t\tfont-size: 0.8em;\r\n\t}\r\n\t.accordion-content {\r\n\t\tpadding: 15px 10px;\r\n\t\tbackground-color: white;\r\n\t}\r\n</style>"],"mappings":";;;AACiD;AAChD,OAAOA,SAAS,MAAM,iBAAiB;AACvC,OAAOC,KAAK,MAAM,iBAAiB,CAAC,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;IAErC,MAAMC,KAAK,GAAGC,OAiBZ;;IAIF;IACA,MAAMC,YAAY,GAAG,MAAAA,CAAA,KAAY;MAChC,IAAI;QACH,MAAMC,QAAQ,GAAG,MAAMJ,KAAK,CAACK,GAAG,CAAE,aAAYJ,KAAK,CAACK,MAAO,EAAC,EAAE;UAC7DC,YAAY,EAAE,MAAM,CAAE;QACvB,CAAC,CAAC;;QAEF;QACA,MAAMC,kBAAkB,GAAGJ,QAAQ,CAACK,OAAO,CAAC,qBAAqB,CAAC;QAClE,IAAIC,QAAQ,GAAI,oBAAmBT,KAAK,CAACK,MAAO,MAAK,CAAC,CAAC;QACvD,IAAIE,kBAAkB,EAAE;UACvB,MAAMG,aAAa,GAAGH,kBAAkB,CAACI,KAAK,CAAC,oBAAoB,CAAC;UACpE,IAAID,aAAa,IAAIA,aAAa,CAACE,MAAM,KAAK,CAAC,EAAE;YAChDH,QAAQ,GAAGC,aAAa,CAAC,CAAC,CAAC;UAC5B;QACD;;QAEA;QACA,MAAMG,GAAG,GAAGC,MAAM,CAACC,GAAG,CAACC,eAAe,CAAC,IAAIC,IAAI,CAAC,CAACd,QAAQ,CAACe,IAAI,CAAC,CAAC,CAAC;QACjE,MAAMC,IAAI,GAAGC,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC;QACxCF,IAAI,CAACG,IAAI,GAAGT,GAAG;QACfM,IAAI,CAACI,YAAY,CAAC,UAAU,EAAEd,QAAQ,CAAC,CAAC,CAAC;QACzCW,QAAQ,CAACI,IAAI,CAACC,WAAW,CAACN,IAAI,CAAC;QAC/BA,IAAI,CAACO,KAAK,CAAC,CAAC;;QAEZ;QACAP,IAAI,CAACQ,UAAU,CAACC,WAAW,CAACT,IAAI,CAAC;QACjCL,MAAM,CAACC,GAAG,CAACc,eAAe,CAAChB,GAAG,CAAC;MAEhC,CAAC,CAAC,OAAOiB,KAAK,EAAE;QACfC,OAAO,CAACD,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;QAChD;QACAE,KAAK,CAAC,2EAA2E,CAAC;QAClF;MACD;IACD,CAAC;IACD","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}