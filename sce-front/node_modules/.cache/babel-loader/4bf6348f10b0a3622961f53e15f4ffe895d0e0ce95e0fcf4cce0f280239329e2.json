{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport OrientadorNavigation from '@/components/orientador/OrientadorNavigation.vue';\nimport RoundedBox from '@/components/base/RoundedBox.vue';\nimport TheAlert from '@/components/base/TheAlert.vue';\nimport axios from \"@/misc/axios.js\";\nimport constants from \"@/misc/constants.js\";\nexport default {\n  components: {\n    OrientadorNavigation,\n    RoundedBox,\n    TheAlert\n  },\n  data() {\n    return {\n      // Dados para atualização de preferencias\n      // v-model dos campos do formulário\n      nome: '',\n      email: '',\n      campus: '',\n      cursos: [],\n      // Flags de validação\n      validNome: true,\n      validEmail: true,\n      validCampus: true,\n      validCursos: true,\n      // Flags de campos ativos para setar o z-index\n      activeNome: false,\n      activeEmail: false,\n      activeCampus: false,\n      // Dados obtidos do BD\n      cursosCampus: [],\n      // Flag do request / usado para exibir o Spinner\n      isLoading: true,\n      isUpdating: false,\n      // Arrays de erros / usado no Alert\n      errorMessage: []\n    };\n  },\n  methods: {\n    async loadPreferencias() {\n      try {\n        this.isLoading = true;\n        this.errorMessage = [];\n        let response = await axios.get(\"/orientador/preferencias\");\n        if (response && response.data) {\n          this.nome = response.data.nome;\n          this.email = response.data.email;\n          this.campus = response.data.campus;\n          this.cursos = response.data.cursos;\n          await this.loadCursos();\n        }\n        this.checkPreferences();\n      } catch (error) {\n        this.handleError(error);\n      } finally {\n        this.isLoading = false;\n      }\n    },\n    async loadCursos() {\n      try {\n        this.isLoading = true;\n        this.errorMessage = [];\n        const params = {\n          campus: this.campus.id\n        };\n        let response = await axios.get(\"/cursos\", {\n          params\n        });\n        if (response && response.data) this.cursosCampus = response.data;\n      } catch (error) {\n        this.handleError(error);\n      } finally {\n        this.isLoading = false;\n      }\n    },\n    setCurso(e) {\n      const id = Number(e.target.id);\n      if (e.target.checked && !this.cursos.includes(id)) this.cursos.push(id);else if (!e.target.checked && this.cursos.includes(id)) this.cursos = this.cursos.filter(e => e !== id);\n    },\n    async updateOrientador() {\n      if (this.checkPreferences()) {\n        try {\n          this.isUpdating = true;\n          let response = await axios.put(\"/orientador/preferencias\", {\n            nome: this.nome,\n            cursos: this.cursos\n          });\n          if (response.status === 200) await this.loadPreferencias();\n        } catch (error) {\n          this.handleError(error);\n        } finally {\n          this.isUpdating = false;\n        }\n      }\n    },\n    checkPreferences() {\n      this.validNome = true;\n      this.validEmail = true;\n      this.validCampus = true;\n      this.validCursos = true;\n      this.errorMessage = [];\n      if (!this.nome || this.nome.length < constants.MIN_LENGTH_NOME) {\n        this.validNome = false;\n        this.errorMessage.push(this.$t('error.nome-caracteres'));\n      }\n      if (!this.email) {\n        this.validEmail = false;\n        this.errorMessage.push(this.$t('error.email-formato'));\n      }\n      if (!this.campus) {\n        this.validCampus = false;\n        this.errorMessage.push(this.$t('error.campus-selecionado'));\n      }\n      if (!this.cursos || this.cursos.length === 0) {\n        this.validCursos = false;\n        this.errorMessage.push(this.$t('error.cursos-selecionados'));\n      }\n      return this.validNome && this.validEmail && this.validCampus && this.validCursos;\n    },\n    handleError(error) {\n      if (error.response && error.response.data && error.response.data.error) this.errorMessage.push(error.response.data.error);else this.errorMessage.push(error.message);\n    }\n  },\n  mounted() {\n    this.loadPreferencias();\n  }\n};","map":{"version":3,"names":["OrientadorNavigation","RoundedBox","TheAlert","axios","constants","components","data","nome","email","campus","cursos","validNome","validEmail","validCampus","validCursos","activeNome","activeEmail","activeCampus","cursosCampus","isLoading","isUpdating","errorMessage","methods","loadPreferencias","response","get","loadCursos","checkPreferences","error","handleError","params","id","setCurso","e","Number","target","checked","includes","push","filter","updateOrientador","put","status","length","MIN_LENGTH_NOME","$t","message","mounted"],"sources":["C:\\Users\\THIAGO\\Documents\\Estágios\\sce-front\\src\\components\\orientador\\OrientadorPreferencias.vue"],"sourcesContent":["<template>\r\n  <div>\r\n\r\n    <OrientadorNavigation />\r\n\r\n    <div class=\"container\">\r\n\r\n      <RoundedBox>\r\n\r\n        <h3 class=\"text-center\">{{ $t('header.orientador.preferencias') }}</h3>\r\n\r\n        <div class=\"sce-form\">\r\n          <form @submit.prevent=\"\">\r\n\r\n\r\n            <div :class=\"{\r\n              'z-1': !activeNome && validNome,\r\n              'z-2': !activeNome && !validNome,\r\n              'z-3': activeNome, }\" class=\"form-floating\">\r\n\r\n                      <input type=\"text\" class=\"form-control sce-form-top\" @focus=\"activeNome = true\" \r\n                        @blur=\"activeNome = false, checkPreferences()\"\r\n                        :class=\"{ 'is-invalid': !validNome }\" id=\"orientadorNome\" name=\"orientadorNome\"\r\n                        placeholder=\"Nome\" v-model.trim=\"nome\" autocomplete=\"off\">\r\n                      <label for=\"orientadorNome\">Nome</label>\r\n            </div>\r\n\r\n            <div :class=\"{\r\n              'z-1': !activeEmail && validEmail,\r\n              'z-2': !activeEmail && !validEmail,\r\n              'z-3': activeEmail, }\" class=\"form-floating\">\r\n\r\n                  <input type=\"email\" class=\"form-control sce-form-middle\" @focus=\"activeEmail = true\"\r\n                    @blur=\"activeEmail = false, checkPreferences()\"\r\n                    :class=\"{ 'is-invalid': !validEmail }\" id=\"orientadorEmail\"\r\n                    name=\"orientadorEmail\" placeholder=\"Email\" v-model.trim=\"email\" autocomplete=\"off\"\r\n                    readonly=\"readlonly\" disabled=\"disabled\">\r\n                  <label for=\"orientadorEmail\">Email</label>\r\n            </div>\r\n\r\n\r\n            <div :class=\"{\r\n                  'z-1': !activeCampus && validCampus,\r\n                  'z-2': !activeCampus && !validCampus,\r\n                  'z-3': activeCampus, }\" class=\"form-floating\">\r\n\r\n                  <input type=\"text\" class=\"form-control sce-form-bottom\" @focus=\"activeCampus = true\"\r\n                    @blur=\"activeCampus = false, checkPreferences()\"\r\n                    :class=\"{ 'is-invalid': !validCampus }\" id=\"orientadorCampus\"\r\n                    name=\"orientadorCampus\" placeholder=\"Campus\" v-model.trim=\"campus.descricao\" autocomplete=\"off\" \r\n                    readonly=\"readlonly\" disabled=\"disabled\">\r\n                  \r\n                    <label for=\"orientadorCampus\">Campus</label>\r\n            </div>\r\n\r\n            <div class=\"my-4\" :class=\"{ 'is-invalid-div': !validCursos }\">\r\n\r\n              <div class=\"mx-4 mt-2\">Cursos</div>\r\n              \r\n              <div class=\"mx-4 my-2 form-check\" v-for=\"c in cursosCampus\" :key=\"c.id\" >\r\n                <input class=\"form-check-input\" type=\"checkbox\" \r\n                  :value=\"c.id\" :id=\"c.id\" :checked=\"cursos.includes(c.id)\"\r\n                  @change=\"setCurso\">\r\n                <label class=\"form-check-label\" :for=\"c.id\">\r\n                  {{ c.descricao }} \r\n                </label>\r\n              </div>\r\n\r\n            </div>\r\n\r\n            <div class=\"text-center\">\r\n              <button class=\"w-25 mt-3 btn btn-outline-success opacity-75\" type=\"submit\" @click=\"updateOrientador\"\r\n                :disabled=\"!nome || isUpdating || isLoading\">\r\n                <span v-if=\"isUpdating\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n                {{ $t('button.update') }}\r\n              </button>\r\n            </div>\r\n\r\n            <TheAlert :messages=\"errorMessage\"></TheAlert>\r\n\r\n          </form>\r\n        </div>\r\n\r\n      </RoundedBox>\r\n\r\n      \r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport OrientadorNavigation from '@/components/orientador/OrientadorNavigation.vue';\r\nimport RoundedBox from '@/components/base/RoundedBox.vue';\r\nimport TheAlert from '@/components/base/TheAlert.vue';\r\nimport axios from \"@/misc/axios.js\";\r\nimport constants from \"@/misc/constants.js\";\r\n\r\n\r\nexport default {\r\n  components: {\r\n    OrientadorNavigation,\r\n    RoundedBox,\r\n    TheAlert,\r\n  },\r\n\r\n  data() {\r\n    return {\r\n      // Dados para atualização de preferencias\r\n      // v-model dos campos do formulário\r\n      nome: '',\r\n      email: '',\r\n      campus: '',\r\n      cursos: [],\r\n\r\n      // Flags de validação\r\n      validNome: true,\r\n      validEmail: true,\r\n      validCampus: true,\r\n      validCursos: true,\r\n\r\n      // Flags de campos ativos para setar o z-index\r\n      activeNome: false,\r\n      activeEmail: false,\r\n      activeCampus: false,\r\n\r\n      // Dados obtidos do BD\r\n      cursosCampus: [],\r\n\r\n      // Flag do request / usado para exibir o Spinner\r\n      isLoading: true,\r\n      isUpdating: false,\r\n\r\n      // Arrays de erros / usado no Alert\r\n      errorMessage: [],\r\n    }\r\n  },\r\n\r\n  methods: {\r\n\r\n    async loadPreferencias() {\r\n      try {\r\n        this.isLoading = true;\r\n        this.errorMessage = [];\r\n        let response = await axios.get(\"/orientador/preferencias\");\r\n\r\n        if (response && response.data) {\r\n          this.nome = response.data.nome;\r\n          this.email = response.data.email;\r\n          this.campus = response.data.campus;\r\n          this.cursos = response.data.cursos;          \r\n          await this.loadCursos();\r\n        }\r\n\r\n        this.checkPreferences();\r\n\r\n      } catch (error) {\r\n        this.handleError(error);\r\n      } finally {\r\n        this.isLoading = false;\r\n      }\r\n    },\r\n\r\n    async loadCursos() {\r\n      try {\r\n        this.isLoading = true;\r\n        this.errorMessage = [];\r\n        const params = { campus: this.campus.id };        \r\n        let response = await axios.get(\"/cursos\", { params });\r\n        if (response && response.data) this.cursosCampus = response.data;\r\n      } catch (error) {\r\n        this.handleError(error);\r\n      } finally {\r\n        this.isLoading = false;\r\n      }\r\n    },\r\n\r\n    setCurso(e) {\r\n      const id = Number(e.target.id);\r\n      if(e.target.checked && !this.cursos.includes(id))\r\n        this.cursos.push(id);\r\n      else if(!e.target.checked && this.cursos.includes(id))\r\n        this.cursos = this.cursos.filter(e => e !== id)        \r\n    },\r\n\r\n    async updateOrientador() {\r\n      \r\n      if(this.checkPreferences()) {\r\n        try {\r\n          this.isUpdating = true;\r\n          let response = await axios.put(\"/orientador/preferencias\", { nome: this.nome, cursos: this.cursos });\r\n          if (response.status === 200)  await this.loadPreferencias();\r\n        } catch (error) {\r\n          this.handleError(error);\r\n        } finally {\r\n          this.isUpdating = false;\r\n        }\r\n      }\r\n    },\r\n\r\n    checkPreferences() {\r\n      this.validNome = true;\r\n      this.validEmail = true;\r\n      this.validCampus = true;\r\n      this.validCursos = true;\r\n\r\n      this.errorMessage = [];\r\n\r\n      if(!this.nome || this.nome.length < constants.MIN_LENGTH_NOME) {\r\n        this.validNome = false;\r\n        this.errorMessage.push(this.$t('error.nome-caracteres'));\r\n      }\r\n\r\n      if(!this.email) {\r\n        this.validEmail = false;\r\n        this.errorMessage.push(this.$t('error.email-formato'));\r\n      }\r\n\r\n      if(!this.campus) {\r\n        this.validCampus = false;\r\n        this.errorMessage.push(this.$t('error.campus-selecionado'));\r\n      }\r\n\r\n      if(!this.cursos || this.cursos.length === 0) {\r\n        this.validCursos = false;\r\n        this.errorMessage.push(this.$t('error.cursos-selecionados'));\r\n      }\r\n\r\n      return (this.validNome && this.validEmail && this.validCampus && this.validCursos);\r\n    },\r\n\r\n    handleError(error) {\r\n      if (error.response && error.response.data && error.response.data.error)\r\n        this.errorMessage.push(error.response.data.error);\r\n      else\r\n        this.errorMessage.push(error.message);\r\n    },\r\n\r\n  },\r\n\r\n  mounted() {\r\n    this.loadPreferencias();\r\n  }\r\n}\r\n</script>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}