{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref, computed } from \"vue\";\nimport { useStore } from \"vuex\";\nimport { useRouter } from \"vue-router\";\n//import { useI18n } from 'vue-i18n';\nimport TheLogo from \"@/components/base/TheLogo.vue\";\nimport RoundedBox from \"@/components/base/RoundedBox.vue\";\nimport TheAlert from \"@/components/base/TheAlert.vue\";\nimport { validateEmail } from \"@/misc/validation.js\";\nimport constants from \"@/misc/constants.js\";\nexport default {\n  __name: 'AdminLogin',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const store = useStore();\n    const router = useRouter();\n    //const { t } = useI18n();\n\n    // Dados para login\n    // v-model dos campos do formulário\n    const email = ref(\"\");\n    const password = ref(\"\");\n\n    // Flags de validação\n    const validEmail = ref(true);\n    const validPassword = ref(true);\n\n    // Flags de campos ativos para setar o z-index\n    const activeEmail = ref(false);\n    const activePassword = ref(false);\n\n    // Arrays de erros\n    const errorMessages = ref([]);\n\n    // Usados para exibir o spinner\n    const isLoading = ref(false);\n    const isAdmin = computed(() => store.getters.isAdmin);\n    const handleError = error => {\n      const message = error.response?.data?.error || error.message;\n      errorMessages.value.push(message);\n    };\n    const login = async () => {\n      errorMessages.value = [];\n      validEmail.value = true;\n      validPassword.value = true;\n      if (!email.value || !validateEmail(email.value)) {\n        validEmail.value = false;\n        errorMessages.value.push(this.$t(\"error.email-formato\"));\n      }\n      if (!password.value || password.value.length < constants.MIN_LENGTH_PASSWD) {\n        validPassword.value = false;\n        errorMessages.value.push(this.$t(\"error.password-tamanho\"));\n      }\n      if (errorMessages.value.length > 0) return;\n      const payload = {\n        email: email.value,\n        password: password.value\n      };\n      try {\n        isLoading.value = true;\n        // 1. O backend define o cookie aqui\n        await store.dispatch(\"loginAdmin\", payload);\n\n        // 2. <-- CORREÇÃO: Adicionada esta linha\n        // Use o cookie para buscar os dados do usuário e popular o Vuex\n        await store.dispatch(\"startSession\");\n\n        // 3. Agora o isAdmin.value será verdadeiro\n        if (isAdmin.value) {\n          router.replace(\"/admin/coordenador/estagio\");\n        } else {\n          errorMessages.value.push(this.$t(\"error.nao-admin\"));\n        }\n      } catch (error) {\n        handleError(error);\n      } finally {\n        isLoading.value = false;\n      }\n    };\n    const __returned__ = {\n      store,\n      router,\n      email,\n      password,\n      validEmail,\n      validPassword,\n      activeEmail,\n      activePassword,\n      errorMessages,\n      isLoading,\n      isAdmin,\n      handleError,\n      login,\n      ref,\n      computed,\n      get useStore() {\n        return useStore;\n      },\n      get useRouter() {\n        return useRouter;\n      },\n      TheLogo,\n      RoundedBox,\n      TheAlert,\n      get validateEmail() {\n        return validateEmail;\n      },\n      get constants() {\n        return constants;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","useStore","useRouter","TheLogo","RoundedBox","TheAlert","validateEmail","constants","store","router","email","password","validEmail","validPassword","activeEmail","activePassword","errorMessages","isLoading","isAdmin","getters","handleError","error","message","response","data","value","push","login","$t","length","MIN_LENGTH_PASSWD","payload","dispatch","replace"],"sources":["C:/Users/THIAGO/Documents/Estágios/sce-front/src/components/admin/AdminLogin.vue"],"sourcesContent":["<script setup>\r\n\timport { ref, computed } from \"vue\";\r\n\timport { useStore } from \"vuex\";\r\n\timport { useRouter } from \"vue-router\";\r\n\t//import { useI18n } from 'vue-i18n';\r\n\timport TheLogo from \"@/components/base/TheLogo.vue\";\r\n\timport RoundedBox from \"@/components/base/RoundedBox.vue\";\r\n\timport TheAlert from \"@/components/base/TheAlert.vue\";\r\n\timport { validateEmail } from \"@/misc/validation.js\";\r\n\timport constants from \"@/misc/constants.js\";\r\n\r\n\tconst store = useStore();\r\n\tconst router = useRouter();\r\n\t//const { t } = useI18n();\r\n\r\n\t// Dados para login\r\n\t// v-model dos campos do formulário\r\n\tconst email = ref(\"\");\r\n\tconst password = ref(\"\");\r\n\r\n\t// Flags de validação\r\n\tconst validEmail = ref(true);\r\n\tconst validPassword = ref(true);\r\n\r\n\t// Flags de campos ativos para setar o z-index\r\n\tconst activeEmail = ref(false);\r\n\tconst activePassword = ref(false);\r\n\r\n\t// Arrays de erros\r\n\tconst errorMessages = ref([]);\r\n\r\n\t// Usados para exibir o spinner\r\n\tconst isLoading = ref(false);\r\n\r\n\tconst isAdmin = computed(() => store.getters.isAdmin);\r\n\r\n\tconst handleError = (error) => {\r\n\t\tconst message = error.response?.data?.error || error.message;\r\n\t\terrorMessages.value.push(message);\r\n\t};\r\n\r\n\tconst login = async () => {\r\n\t\terrorMessages.value = [];\r\n\t\tvalidEmail.value = true;\r\n\t\tvalidPassword.value = true;\r\n\r\n\t\tif (!email.value || !validateEmail(email.value)) {\r\n\t\t\tvalidEmail.value = false;\r\n\t\t\terrorMessages.value.push(this.$t(\"error.email-formato\"));\r\n\t\t}\r\n\t\tif (\r\n\t\t\t!password.value ||\r\n\t\t\tpassword.value.length < constants.MIN_LENGTH_PASSWD\r\n\t\t) {\r\n\t\t\tvalidPassword.value = false;\r\n\t\t\terrorMessages.value.push(this.$t(\"error.password-tamanho\"));\r\n\t\t}\r\n\r\n\t\tif (errorMessages.value.length > 0) return;\r\n\r\n\t\tconst payload = {\r\n\t\t\temail: email.value,\r\n\t\t\tpassword: password.value,\r\n\t\t};\r\n\r\n\t\ttry {\r\n\t\t\tisLoading.value = true;\r\n\t\t\t// 1. O backend define o cookie aqui\r\n\t\t\tawait store.dispatch(\"loginAdmin\", payload);\r\n\r\n\t\t\t// 2. <-- CORREÇÃO: Adicionada esta linha\r\n\t\t\t// Use o cookie para buscar os dados do usuário e popular o Vuex\r\n\t\t\tawait store.dispatch(\"startSession\");\r\n\r\n\t\t\t// 3. Agora o isAdmin.value será verdadeiro\r\n\t\t\tif (isAdmin.value) {\r\n\t\t\t\trouter.replace(\"/admin/coordenador/estagio\");\r\n\t\t\t} else {\r\n\t\t\t\terrorMessages.value.push(this.$t(\"error.nao-admin\"));\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\thandleError(error);\r\n\t\t} finally {\r\n\t\t\tisLoading.value = false;\r\n\t\t}\r\n\t};\r\n</script>\r\n\r\n<template>\r\n\t<div class=\"sce-form vertical-align\">\r\n\t\t<RoundedBox>\r\n\t\t\t<TheLogo />\r\n\r\n\t\t\t<form @submit.prevent=\"login\">\r\n\t\t\t\t<div\r\n\t\t\t\t\t:class=\"{\r\n\t\t\t\t\t\t'z-1': !activeEmail && validEmail,\r\n\t\t\t\t\t\t'z-2': !activeEmail && !validEmail,\r\n\t\t\t\t\t\t'z-3': activeEmail,\r\n\t\t\t\t\t}\"\r\n\t\t\t\t\tclass=\"form-floating\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\t@focus=\"activeEmail = true\"\r\n\t\t\t\t\t\t@blur=\"activeEmail = false\"\r\n\t\t\t\t\t\t:class=\"{ 'is-invalid': !validEmail }\"\r\n\t\t\t\t\t\ttype=\"email\"\r\n\t\t\t\t\t\tclass=\"form-control sce-form-top\"\r\n\t\t\t\t\t\tid=\"loginEmail\"\r\n\t\t\t\t\t\tname=\"loginEmail\"\r\n\t\t\t\t\t\tplaceholder=\"Email\"\r\n\t\t\t\t\t\tv-model.trim=\"email\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<label for=\"loginEmail\">{{ $t(\"label.email\") }}</label>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div\r\n\t\t\t\t\t:class=\"{\r\n\t\t\t\t\t\t'z-1': !activePassword && validPassword,\r\n\t\t\t\t\t\t'z-2': !activePassword && !validPassword,\r\n\t\t\t\t\t\t'z-3': activePassword,\r\n\t\t\t\t\t}\"\r\n\t\t\t\t\tclass=\"form-floating\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\t@focus=\"activePassword = true\"\r\n\t\t\t\t\t\t@blur=\"activePassword = false\"\r\n\t\t\t\t\t\t:class=\"{ 'is-invalid': !validPassword }\"\r\n\t\t\t\t\t\ttype=\"password\"\r\n\t\t\t\t\t\tclass=\"form-control sce-form-bottom\"\r\n\t\t\t\t\t\tid=\"loginPassword\"\r\n\t\t\t\t\t\tname=\"loginPassword\"\r\n\t\t\t\t\t\tplaceholder=\"Password\"\r\n\t\t\t\t\t\tv-model.trim=\"password\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<label for=\"loginPassword\">{{\r\n\t\t\t\t\t\t$t(\"label.password\")\r\n\t\t\t\t\t}}</label>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<button\r\n\t\t\t\t\tclass=\"w-100 mt-3 btn btn-outline-success opacity-75\"\r\n\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t>\r\n\t\t\t\t\t{{ $t(\"button.login\") }}\r\n\t\t\t\t</button>\r\n\r\n\t\t\t\t<TheAlert :messages=\"errorMessages\"></TheAlert>\r\n\t\t\t</form>\r\n\t\t</RoundedBox>\r\n\t\t<div\r\n\t\t\tv-if=\"isLoading\"\r\n\t\t\tclass=\"d-flex justify-content-center\"\r\n\t\t>\r\n\t\t\t<span class=\"loader\"></span>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<style scoped>\r\n\thtml,\r\n\tbody {\r\n\t\theight: 100%;\r\n\t}\r\n\r\n\tbody {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tpadding-top: 40px;\r\n\t\tpadding-bottom: 40px;\r\n\t\tbackground-color: #f5f5f5;\r\n\t}\r\n\r\n\t.vertical-align {\r\n\t\tmargin-top: 200px;\r\n\t}\r\n\r\n\t.loader {\r\n\t\twidth: 96%;\r\n\t\theight: 7px;\r\n\t\tdisplay: inline-block;\r\n\t\tposition: relative;\r\n\t\tbackground: transparent;\r\n\t\toverflow: hidden;\r\n\t}\r\n\t.loader::after {\r\n\t\tcontent: \"\";\r\n\t\twidth: 96px;\r\n\t\theight: 7px;\r\n\t\tbackground: #0d12a9;\r\n\t\tposition: absolute;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\tbox-sizing: border-box;\r\n\t\tanimation: animloader 1s linear infinite;\r\n\t}\r\n\r\n\t@keyframes animloader {\r\n\t\t0% {\r\n\t\t\tleft: 0;\r\n\t\t\ttransform: translateX(-100%);\r\n\t\t}\r\n\t\t100% {\r\n\t\t\tleft: 100%;\r\n\t\t\ttransform: translateX(0%);\r\n\t\t}\r\n\t}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}