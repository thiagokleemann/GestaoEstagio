{"ast":null,"code":"import \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport UploadBox from \"./UploadBox.vue\";\nimport axios from \"@/misc/axios.js\"; // Importar axios\n\nexport default {\n  __name: 'AccordionItem',\n  props: {\n    title: {\n      type: String,\n      required: true\n    },\n    content: {\n      type: String,\n      required: true\n    },\n    isOpen: {\n      type: Boolean,\n      default: false\n    },\n    tipoId: {\n      type: Number,\n      required: true\n    }\n  },\n  emits: [\"toggle\"],\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const props = __props;\n\n    // Função para download via Axios\n    const baixarModelo = async () => {\n      console.log(`Tentando baixar modelo ID: ${props.tipoId}`); // Log para depuração\n      try {\n        // Verifica se a baseURL está definida antes de usar\n        if (!axios.defaults.baseURL) {\n          console.error(\"Axios baseURL não está definida!\");\n          alert(\"Erro de configuração: A URL do backend não está definida.\");\n          return;\n        }\n        console.log(`Usando baseURL: ${axios.defaults.baseURL}`); // Log para depuração\n\n        const response = await axios.get(`/download/${props.tipoId}`, {\n          responseType: \"blob\"\n        });\n        console.log(\"Resposta do download recebida:\", response.headers); // Log para depuração\n\n        const contentDisposition = response.headers[\"content-disposition\"];\n        let filename = `modelo_documento_${props.tipoId}.doc`;\n        if (contentDisposition) {\n          const filenameMatch = contentDisposition.match(/filename=\"?(.+)\"?/i);\n          if (filenameMatch && filenameMatch.length === 2) {\n            filename = filenameMatch[1];\n          }\n        }\n        console.log(`Nome do arquivo: ${filename}`); // Log para depuração\n\n        const url = window.URL.createObjectURL(new Blob([response.data]));\n        const link = document.createElement(\"a\");\n        link.href = url;\n        link.setAttribute(\"download\", filename);\n        document.body.appendChild(link);\n        link.click();\n        link.parentNode.removeChild(link);\n        window.URL.revokeObjectURL(url);\n        console.log(\"Download iniciado com sucesso.\"); // Log para depuração\n      } catch (error) {\n        console.error(\"Erro detalhado ao baixar o modelo:\", error.response || error.message || error); // Log mais detalhado\n        alert(\"Não foi possível baixar o modelo. Verifique o console (F12) para mais detalhes.\");\n      }\n    };\n    const __returned__ = {\n      props,\n      baixarModelo,\n      UploadBox,\n      get axios() {\n        return axios;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["UploadBox","axios","props","__props","baixarModelo","console","log","tipoId","defaults","baseURL","error","alert","response","get","responseType","headers","contentDisposition","filename","filenameMatch","match","length","url","window","URL","createObjectURL","Blob","data","link","document","createElement","href","setAttribute","body","appendChild","click","parentNode","removeChild","revokeObjectURL","message"],"sources":["C:/Users/THIAGO/Documents/Estágios/sce-front/src/components/UI/AccordionItem.vue"],"sourcesContent":["<script setup>\r\n\timport { defineProps, defineEmits } from \"vue\";\r\n\timport UploadBox from \"./UploadBox.vue\";\r\n\timport axios from \"@/misc/axios.js\"; // Importar axios\r\n\r\n\tconst props = defineProps({\r\n\t\ttitle: {\r\n\t\t\ttype: String,\r\n\t\t\trequired: true,\r\n\t\t},\r\n\t\tcontent: {\r\n\t\t\ttype: String,\r\n\t\t\trequired: true,\r\n\t\t},\r\n\t\tisOpen: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false,\r\n\t\t},\r\n\t\ttipoId: {\r\n\t\t\ttype: Number,\r\n\t\t\trequired: true,\r\n\t\t},\r\n\t});\r\n\r\n\tdefineEmits([\"toggle\"]);\r\n\r\n\t// Função para download via Axios\r\n\tconst baixarModelo = async () => {\r\n\t\tconsole.log(`Tentando baixar modelo ID: ${props.tipoId}`); // Log para depuração\r\n\t\ttry {\r\n\t\t\t// Verifica se a baseURL está definida antes de usar\r\n\t\t\tif (!axios.defaults.baseURL) {\r\n\t\t\t\tconsole.error(\"Axios baseURL não está definida!\");\r\n\t\t\t\talert(\"Erro de configuração: A URL do backend não está definida.\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconsole.log(`Usando baseURL: ${axios.defaults.baseURL}`); // Log para depuração\r\n\r\n\t\t\tconst response = await axios.get(`/download/${props.tipoId}`, {\r\n\t\t\t\tresponseType: \"blob\", \r\n\t\t\t});\r\n\r\n\t\t\tconsole.log(\"Resposta do download recebida:\", response.headers); // Log para depuração\r\n\r\n\t\t\tconst contentDisposition = response.headers[\"content-disposition\"];\r\n\t\t\tlet filename = `modelo_documento_${props.tipoId}.doc`; \r\n\t\t\tif (contentDisposition) {\r\n\t\t\t\tconst filenameMatch = contentDisposition.match(/filename=\"?(.+)\"?/i);\r\n\t\t\t\tif (filenameMatch && filenameMatch.length === 2) {\r\n\t\t\t\t\tfilename = filenameMatch[1];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconsole.log(`Nome do arquivo: ${filename}`); // Log para depuração\r\n\r\n\r\n\t\t\tconst url = window.URL.createObjectURL(new Blob([response.data]));\r\n\t\t\tconst link = document.createElement(\"a\");\r\n\t\t\tlink.href = url;\r\n\t\t\tlink.setAttribute(\"download\", filename); \r\n\t\t\tdocument.body.appendChild(link);\r\n\t\t\tlink.click();\r\n\r\n\t\t\tlink.parentNode.removeChild(link);\r\n\t\t\twindow.URL.revokeObjectURL(url);\r\n\t\t\tconsole.log(\"Download iniciado com sucesso.\"); // Log para depuração\r\n\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Erro detalhado ao baixar o modelo:\", error.response || error.message || error); // Log mais detalhado\r\n\t\t\talert(\"Não foi possível baixar o modelo. Verifique o console (F12) para mais detalhes.\");\r\n\t\t}\r\n\t};\r\n\r\n</script>\r\n\r\n<template>\r\n\t<div class=\"accordion-item\">\r\n\t\t<div\r\n\t\t\tclass=\"accordion-header\"\r\n\t\t\t@click=\"$emit('toggle')\"\r\n\t\t>\r\n\t\t\t{{ title }}\r\n\t\t\t<span class=\"toggle-icon\">{{ isOpen ? \"▲\" : \"▼\" }}</span>\r\n\t\t</div>\r\n\r\n\t\t<div\r\n\t\t\tv-if=\"isOpen\"\r\n\t\t\tclass=\"accordion-content\"\r\n\t\t>\r\n\t\t\t<div class=\"mb-3\">\r\n\t\t\t\t<strong>Modelo:</strong>\r\n\t\t\t\t<a href=\"#\" @click.prevent=\"baixarModelo\"> \r\n\t\t\t\t\tBaixar o modelo do documento\r\n\t\t\t\t</a>\r\n\t\t\t\t<p class=\"text-muted small\">\r\n\t\t\t\t\tPreencha o modelo, salve como PDF e envie abaixo.\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<hr>\r\n\r\n\t\t\t<p><strong>Envio:</strong></p>\r\n\t\t\t<UploadBox :multiple=\"false\" />\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<style scoped>\r\n\t/* Seus estilos */\r\n\t.accordion-item { border-bottom: 1px solid #eee; }\r\n\t.accordion-header { padding: 10px; cursor: pointer; background-color: #f7f7f7; display: flex; justify-content: space-between; align-items: center; font-weight: 500; }\r\n\t.accordion-header:hover { background-color: #eee; }\r\n\t.toggle-icon { margin-left: 10px; font-size: 0.8em; }\r\n\t.accordion-content { padding: 15px 10px; background-color: white; }\r\n</style>"],"mappings":";;;AAEC,OAAOA,SAAS,MAAM,iBAAiB;AACvC,OAAOC,KAAK,MAAM,iBAAiB,CAAC,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;IAErC,MAAMC,KAAK,GAAGC,OAiBZ;;IAIF;IACA,MAAMC,YAAY,GAAG,MAAAA,CAAA,KAAY;MAChCC,OAAO,CAACC,GAAG,CAAE,8BAA6BJ,KAAK,CAACK,MAAO,EAAC,CAAC,CAAC,CAAC;MAC3D,IAAI;QACH;QACA,IAAI,CAACN,KAAK,CAACO,QAAQ,CAACC,OAAO,EAAE;UAC5BJ,OAAO,CAACK,KAAK,CAAC,kCAAkC,CAAC;UACjDC,KAAK,CAAC,2DAA2D,CAAC;UAClE;QACD;QACAN,OAAO,CAACC,GAAG,CAAE,mBAAkBL,KAAK,CAACO,QAAQ,CAACC,OAAQ,EAAC,CAAC,CAAC,CAAC;;QAE1D,MAAMG,QAAQ,GAAG,MAAMX,KAAK,CAACY,GAAG,CAAE,aAAYX,KAAK,CAACK,MAAO,EAAC,EAAE;UAC7DO,YAAY,EAAE;QACf,CAAC,CAAC;QAEFT,OAAO,CAACC,GAAG,CAAC,gCAAgC,EAAEM,QAAQ,CAACG,OAAO,CAAC,CAAC,CAAC;;QAEjE,MAAMC,kBAAkB,GAAGJ,QAAQ,CAACG,OAAO,CAAC,qBAAqB,CAAC;QAClE,IAAIE,QAAQ,GAAI,oBAAmBf,KAAK,CAACK,MAAO,MAAK;QACrD,IAAIS,kBAAkB,EAAE;UACvB,MAAME,aAAa,GAAGF,kBAAkB,CAACG,KAAK,CAAC,oBAAoB,CAAC;UACpE,IAAID,aAAa,IAAIA,aAAa,CAACE,MAAM,KAAK,CAAC,EAAE;YAChDH,QAAQ,GAAGC,aAAa,CAAC,CAAC,CAAC;UAC5B;QACD;QACAb,OAAO,CAACC,GAAG,CAAE,oBAAmBW,QAAS,EAAC,CAAC,CAAC,CAAC;;QAG7C,MAAMI,GAAG,GAAGC,MAAM,CAACC,GAAG,CAACC,eAAe,CAAC,IAAIC,IAAI,CAAC,CAACb,QAAQ,CAACc,IAAI,CAAC,CAAC,CAAC;QACjE,MAAMC,IAAI,GAAGC,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC;QACxCF,IAAI,CAACG,IAAI,GAAGT,GAAG;QACfM,IAAI,CAACI,YAAY,CAAC,UAAU,EAAEd,QAAQ,CAAC;QACvCW,QAAQ,CAACI,IAAI,CAACC,WAAW,CAACN,IAAI,CAAC;QAC/BA,IAAI,CAACO,KAAK,CAAC,CAAC;QAEZP,IAAI,CAACQ,UAAU,CAACC,WAAW,CAACT,IAAI,CAAC;QACjCL,MAAM,CAACC,GAAG,CAACc,eAAe,CAAChB,GAAG,CAAC;QAC/BhB,OAAO,CAACC,GAAG,CAAC,gCAAgC,CAAC,CAAC,CAAC;MAEhD,CAAC,CAAC,OAAOI,KAAK,EAAE;QACfL,OAAO,CAACK,KAAK,CAAC,oCAAoC,EAAEA,KAAK,CAACE,QAAQ,IAAIF,KAAK,CAAC4B,OAAO,IAAI5B,KAAK,CAAC,CAAC,CAAC;QAC/FC,KAAK,CAAC,iFAAiF,CAAC;MACzF;IACD,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}