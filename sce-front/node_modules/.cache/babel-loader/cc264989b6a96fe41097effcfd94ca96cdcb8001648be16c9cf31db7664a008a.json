{"ast":null,"code":"import { ref } from \"vue\"; // <-- 1. Adicionar defineProps\nimport axios from \"axios\";\n\n// 2. Definir a 'tipo' como uma propriedade obrigatória\n\nexport default {\n  __name: 'UploadBox',\n  props: {\n    tipo: {\n      type: Number,\n      required: true\n    }\n  },\n  emits: [\"changed\"],\n  setup(__props, {\n    expose: __expose,\n    emit: __emit\n  }) {\n    __expose();\n    const props = __props;\n\n    // 3. Remover o 'type' fixo\n    // const type = ref(2); // <-- Linha removida\n    const isLoading = ref(false);\n    const file = ref(null);\n    const emit = __emit;\n    function handleFileSelect(e) {\n      const input = e.target;\n      const selectedFile = input?.files[0];\n      if (selectedFile) {\n        file.value = selectedFile;\n        emit(\"changed\", file.value);\n      }\n    }\n    function removeFile() {\n      file.value = null;\n      emit(\"changed\", null);\n    }\n    async function handleUpload() {\n      if (!file.value) {\n        alert(\"Por favor, selecione um arquivo.\");\n        return;\n      }\n      const formData = new FormData();\n      formData.append(\"documento\", file.value);\n      // 4. Usar o 'props.tipo' em vez do 'type.value'\n      formData.append(\"tipo\", props.tipo);\n      isLoading.value = true;\n      try {\n        const response = await axios.post(\"/aluno/documento\", formData, {\n          headers: {\n            \"Content-Type\": \"multipart/form-data\"\n          }\n        });\n        console.log(\"Arquivo enviado com sucesso:\", response.data);\n        alert(\"Arquivo enviado com sucesso! Recarregue a página para ver o status.\");\n        file.value = null;\n        emit(\"changed\", null);\n      } catch (error) {\n        console.error(\"Erro ao enviar o arquivo:\", error);\n        alert(\"Ocorreu um erro ao enviar o arquivo. Tente novamente.\");\n      } finally {\n        isLoading.value = false;\n      }\n    }\n    const __returned__ = {\n      props,\n      isLoading,\n      file,\n      emit,\n      handleFileSelect,\n      removeFile,\n      handleUpload,\n      ref,\n      get axios() {\n        return axios;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","axios","props","__props","isLoading","file","emit","__emit","handleFileSelect","e","input","target","selectedFile","files","value","removeFile","handleUpload","alert","formData","FormData","append","tipo","response","post","headers","console","log","data","error"],"sources":["C:/Users/THIAGO/Documents/Estágios/sce-front/src/components/UI/UploadBox.vue"],"sourcesContent":["<script setup>\r\n\timport { ref, defineEmits, defineProps } from \"vue\"; // <-- 1. Adicionar defineProps\r\n\timport axios from \"axios\";\r\n\r\n\t// 2. Definir a 'tipo' como uma propriedade obrigatória\r\n\tconst props = defineProps({\r\n\t\ttipo: {\r\n\t\t\ttype: Number,\r\n\t\t\trequired: true,\r\n\t\t},\r\n\t});\r\n\r\n\t// 3. Remover o 'type' fixo\r\n\t// const type = ref(2); // <-- Linha removida\r\n\tconst isLoading = ref(false);\r\n\r\n\tconst file = ref(null);\r\n\tconst emit = defineEmits([\"changed\"]);\r\n\r\n\tfunction handleFileSelect(e) {\r\n\t\tconst input = e.target;\r\n\t\tconst selectedFile = input?.files[0];\r\n\t\tif (selectedFile) {\r\n\t\t\tfile.value = selectedFile;\r\n\t\t\temit(\"changed\", file.value);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction removeFile() {\r\n\t\tfile.value = null;\r\n\t\temit(\"changed\", null);\r\n\t}\r\n\r\n\tasync function handleUpload() {\r\n\t\tif (!file.value) {\r\n\t\t\talert(\"Por favor, selecione um arquivo.\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst formData = new FormData();\r\n\r\n\t\tformData.append(\"documento\", file.value);\r\n\t\t// 4. Usar o 'props.tipo' em vez do 'type.value'\r\n\t\tformData.append(\"tipo\", props.tipo);\r\n\r\n\t\tisLoading.value = true;\r\n\r\n\t\ttry {\r\n\t\t\tconst response = await axios.post(\"/aluno/documento\", formData, {\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t\"Content-Type\": \"multipart/form-data\",\r\n\t\t\t\t},\r\n\t\t\t});\r\n\r\n\t\t\tconsole.log(\"Arquivo enviado com sucesso:\", response.data);\r\n\t\t\talert(\"Arquivo enviado com sucesso! Recarregue a página para ver o status.\");\r\n\t\t\tfile.value = null; \r\n\t\t\temit(\"changed\", null);\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Erro ao enviar o arquivo:\", error);\r\n\t\t\talert(\"Ocorreu um erro ao enviar o arquivo. Tente novamente.\");\r\n\t\t} finally {\r\n\t\t\tisLoading.value = false;\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<template>\r\n\t<div>\r\n\t\t<label\r\n\t\t\tfor=\"file-input\"\r\n\t\t\tclass=\"btn btn-primary\"\r\n\t\t\t>Adicionar Envio</label\r\n\t\t>\r\n\t\t<input\r\n\t\t\tid=\"file-input\"\r\n\t\t\ttype=\"file\"\r\n\t\t\t@change=\"handleFileSelect\"\r\n\t\t\thidden\r\n\t\t\tref=\"fileInput\"\r\n\t\t/>\r\n\r\n\t\t<div\r\n\t\t\tv-if=\"file\"\r\n\t\t\tclass=\"file-info\"\r\n\t\t>\r\n\t\t\t<span>{{ file.name }}</span>\r\n\t\t\t<button\r\n\t\t\t\t@click=\"removeFile\"\r\n\t\t\t\t:disabled=\"isLoading\"\r\n\t\t\t\ttitle=\"Remover\"\r\n\t\t\t>\r\n\t\t\t\t&times;\r\n\t\t\t</button>\r\n\t\t</div>\r\n\t\t<p v-else>Nenhum arquivo selecionado.</p>\r\n\r\n\t\t<button\r\n\t\t\tv-if=\"file\"\r\n\t\t\t@click=\"handleUpload\"\r\n\t\t\tclass=\"btn btn-success\"\r\n\t\t\t:disabled=\"isLoading\"\r\n\t\t>\r\n\t\t\t{{ isLoading ? \"Enviando...\" : \"Enviar Arquivo\" }}\r\n\t\t</button>\r\n\t</div>\r\n</template>\r\n\r\n<style scoped>\r\n\t/* Estilos podem ser mantidos ou ajustados */\r\n\t.btn {\r\n\t\tpadding: 8px 12px;\r\n\t\tborder: none;\r\n\t\tborder-radius: 4px;\r\n\t\tcursor: pointer;\r\n\t\tmargin-right: 10px;\r\n\t}\r\n\t.btn-primary {\r\n\t\tbackground-color: #007bff;\r\n\t\tcolor: white;\r\n\t}\r\n\t.btn-success {\r\n\t\tbackground-color: #28a745;\r\n\t\tcolor: white;\r\n\t\tmargin-top: 10px;\r\n\t}\r\n\t.file-info {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\tpadding: 8px;\r\n\t\tborder: 1px solid #ccc;\r\n\t\tborder-radius: 4px;\r\n\t\tmargin-top: 15px;\r\n\t}\r\n\t.file-info button {\r\n\t\tbackground: none;\r\n\t\tborder: none;\r\n\t\tfont-size: 1.2rem;\r\n\t\tcolor: red;\r\n\t\tfont-weight: bold;\r\n\t\tcursor: pointer;\r\n\t}\r\n</style>"],"mappings":"AACC,SAASA,GAA6B,QAAQ,KAAK,CAAC,CAAC;AACrD,OAAOC,KAAK,MAAM,OAAO;;AAEzB;;;;;;;;;;;;;;;;IACA,MAAMC,KAAK,GAAGC,OAKZ;;IAEF;IACA;IACA,MAAMC,SAAS,GAAGJ,GAAG,CAAC,KAAK,CAAC;IAE5B,MAAMK,IAAI,GAAGL,GAAG,CAAC,IAAI,CAAC;IACtB,MAAMM,IAAI,GAAGC,MAAwB;IAErC,SAASC,gBAAgBA,CAACC,CAAC,EAAE;MAC5B,MAAMC,KAAK,GAAGD,CAAC,CAACE,MAAM;MACtB,MAAMC,YAAY,GAAGF,KAAK,EAAEG,KAAK,CAAC,CAAC,CAAC;MACpC,IAAID,YAAY,EAAE;QACjBP,IAAI,CAACS,KAAK,GAAGF,YAAY;QACzBN,IAAI,CAAC,SAAS,EAAED,IAAI,CAACS,KAAK,CAAC;MAC5B;IACD;IAEA,SAASC,UAAUA,CAAA,EAAG;MACrBV,IAAI,CAACS,KAAK,GAAG,IAAI;MACjBR,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC;IACtB;IAEA,eAAeU,YAAYA,CAAA,EAAG;MAC7B,IAAI,CAACX,IAAI,CAACS,KAAK,EAAE;QAChBG,KAAK,CAAC,kCAAkC,CAAC;QACzC;MACD;MAEA,MAAMC,QAAQ,GAAG,IAAIC,QAAQ,CAAC,CAAC;MAE/BD,QAAQ,CAACE,MAAM,CAAC,WAAW,EAAEf,IAAI,CAACS,KAAK,CAAC;MACxC;MACAI,QAAQ,CAACE,MAAM,CAAC,MAAM,EAAElB,KAAK,CAACmB,IAAI,CAAC;MAEnCjB,SAAS,CAACU,KAAK,GAAG,IAAI;MAEtB,IAAI;QACH,MAAMQ,QAAQ,GAAG,MAAMrB,KAAK,CAACsB,IAAI,CAAC,kBAAkB,EAAEL,QAAQ,EAAE;UAC/DM,OAAO,EAAE;YACR,cAAc,EAAE;UACjB;QACD,CAAC,CAAC;QAEFC,OAAO,CAACC,GAAG,CAAC,8BAA8B,EAAEJ,QAAQ,CAACK,IAAI,CAAC;QAC1DV,KAAK,CAAC,qEAAqE,CAAC;QAC5EZ,IAAI,CAACS,KAAK,GAAG,IAAI;QACjBR,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC;MACtB,CAAC,CAAC,OAAOsB,KAAK,EAAE;QACfH,OAAO,CAACG,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;QACjDX,KAAK,CAAC,uDAAuD,CAAC;MAC/D,CAAC,SAAS;QACTb,SAAS,CAACU,KAAK,GAAG,KAAK;MACxB;IACD","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}